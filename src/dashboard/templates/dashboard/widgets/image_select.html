<input id="{{ widget.attrs.id }}" name="{{ widget.name }}" type="hidden" value="{{ widget.value|default:"" }}">

<div class="row align-items-center justify-content-start">
  <div class="col col-md-4">
    {% spaceless %}
      <div id="{{ widget.name }}Selected">{% if multiple %}{{ widget.value|length }} Images selected
      {% else %}
        <img class="small-thumbnail img-thumbnail {% if not url %}invisible{% endif %}" src="{{ url }}">
     {% endif %}
    </div>
    {% endspaceless %}
  </div>
  <div class="col-4 col-md-4">
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#{{ widget.name }}Modal">
      Select image
    </button>
  </div>
</div>

<div class="modal fade" id="{{ widget.name }}Modal" tabindex="-1" role="dialog" aria-labelledby="#{{ widget.name }}ModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="{{ widget.name }}ModalLabel">Select an image</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="images">
          <div class="row" id="{{ widget.name }}Images"></div>
        </div>

        <nav aria-label="Image navigation">
          <ul class="pagination justify-content-center">
            <li id="{{ widget.name }}ButtonPrevious" class="page-item"><button type="button" class="page-link">Previous</button></li>
            <li id="{{ widget.name }}ButtonNext" class="page-item"><button type="button" class="page-link">Next</button></li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>

<script>
  {% if not multiple %}
    widget = new ImageSelectWidget("{{ widget.name }}", false, null)
  {% else %}
    widget = new ImageSelectWidget(
      "{{ widget.name }}",
      true,
      new Set([
        {% for image in widget.value %}
          {{ image.pk }}
          {% if not forloop.last %},{% endif %}
        {% endfor %}
      ])
    )
  {% endif %}

  widget.getImages()
</script>
